(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[385],{2886:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/liquidity",function(){return t(4691)}])},4691:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return Sn}});var o=t(828),i=t(5893),r=t(794),l=t(7294),u=t(8663),c=t(8635),a=t(6527),s=t(2927),d=t(1258),f=t(5539),m=t(2701),v=t(1450),p=t(502),b=t(1681),Z=t(9775),h=t(5695),x=t(4088),g=t(1569),k=t(6361),y=t(4734),S=t(4580),w=t(906),P=t(8397),j=t(2515),A=t(1999),I=t(7055);var N=t(7568),T=t(4051),C=t.n(T),q=t(1163),M=t(9643),L=t(8337),B=t(2693),R=t(8083),E=t(2933),K=t(6979);var V=t(20),D=t(4475),_=t(3393);function O(n){var e=n?(0,p.B)(n):"";return(0,_.eq)(e,0)?"":e}var F=t(8143),U=t(6012),H=t(78);function z(){var n=(0,U.Z)((function(n){return n.connection})),e=(0,g.Z)((function(n){return n.currentPoolInfo})),t=(0,g.Z)((function(n){return n.currentPoolParsedInfo})),o=(0,g.Z)((function(n){return n.coin1})),i=(0,g.Z)((function(n){return n.coin2})),r=(0,g.Z)((function(n){return n.coin1Amount})),u=(0,g.Z)((function(n){return n.coin2Amount})),c=(0,g.Z)((function(n){return n.focusSide})),a=(0,g.Z)((function(n){return n.refreshCount})),s=(0,x.Z)((function(n){return n.slippageTolerance}));(0,l.useEffect)((function(){W.clear()}),[a]),(0,E.Z)((0,N.Z)(C().mark((function n(){var l,a,d,f;return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o&&i&&t&&e){n.next=2;break}return n.abrupt("return");case 2:if(!(!(0,F.CW)([(0,I.ZP)(e.baseMint),(0,I.ZP)(e.quoteMint)],[String(o.mint),String(i.mint)])||"coin1"===c&&(0,_.eq)(r,0)||"coin2"===c&&(0,_.eq)(u,0))){n.next=6;break}return"coin1"===c&&g.Z.setState({coin2Amount:"",unslippagedCoin2Amount:""}),"coin2"===c&&g.Z.setState({coin1Amount:"",unslippagedCoin1Amount:""}),n.abrupt("return");case 6:return n.prev=6,n.next=9,Y({coin1:o,userCoin1Amount:r,coin2:i,userCoin2Amount:u,focusSide:c,currentPoolInfo:e,currentPoolParsedInfo:t,slippageTolerance:s});case 9:if(l=n.sent,a=l.amount,d=l.unslippagedAmount,f=function(){var n=g.Z.getState(),e=n.coin1Amount,t=n.coin2Amount,o="coin1"===c?e:t,i="coin1"===c?r:u;return(0,_.eq)(o,i)}(),f){n.next=15;break}return n.abrupt("return");case 15:"coin1"===c?g.Z.setState({coin2Amount:a,unslippagedCoin2Amount:d}):g.Z.setState({coin1Amount:a,unslippagedCoin1Amount:d}),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(6),console.error("err: ",n.t0);case 21:case"end":return n.stop()}}),n,null,[[6,18]])}))),[o,i,r,u,c,n,t,s,a])}var W=new Map;function Y(n){return X.apply(this,arguments)}function X(){return X=(0,N.Z)(C().mark((function n(e){var t,o,i,r,l,u,c,a,s,d,f,v,p,b;return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.coin1,o=e.coin2,i=e.userCoin1Amount,r=e.userCoin2Amount,l=e.focusSide,u=e.slippageTolerance,c=e.currentPoolInfo,a=e.currentPoolParsedInfo,d=(s="coin1"===l?t:o)===t?o:t,f=(0,D.n)(s,"coin1"===l?i:r,{alreadyDecimaled:!0}),v=H.h.computeAnotherAmount({poolInfo:c,poolParsedInfo:a,amount:(0,m.wO)(f),anotherCurrency:(0,m.et)(d),slippage:(0,V.y)((0,V.y)(u))}),p=v.maxAnotherAmount,b=v.anotherAmount,n.abrupt("return",{amount:O((0,m.wE)(p).toExact()),unslippagedAmount:O((0,m.wE)(b).toExact())});case 6:case"end":return n.stop()}}),n)}))),X.apply(this,arguments)}var $=t(9673),G=t(2670),J=t(602),Q=t(960),nn=t(4025),en=t(8155),tn=t(7855),on=t(3029),rn=t(9039),ln=t(8764).Buffer;var un=t(3874),cn=t(6042),an=t(9396),sn=t(3834),dn=t(4857),fn=t(9384);function mn(n){var e,t=n.increaseRenderCount,r=void 0===t?30:t,u=n.initRenderCount,c=void 0===u?30:u,a=n.reachBottomMargin,s=void 0===a?50:a,d=n.renderAllAtOnce,f=n.domRef,m=n.className,v=n.children,p=n.style,b=(0,l.useMemo)((function(){return(0,fn.lY)(v,mn.Item,(function(n,t){return(0,sn.Z)(n,{key:null!==(e=n.key)&&void 0!==e?e:t,$isRenderByMain:!0})}))}),[v]),Z=(0,l.useState)(d?b.length:c),h=Z[0],x=Z[1],g=(0,l.useRef)(null);return function(n,e){var t=(0,l.useRef)(!1),o=(0,l.useCallback)((function(){if(n.current){var o,i,r=n.current,l=r.scrollHeight,u=r.scrollTop+r.clientHeight+(null!==(o=null===e||void 0===e?void 0:e.reachBottomMargin)&&void 0!==o?o:0)>=l;u&&!t.current&&(null===e||void 0===e||null===(i=e.onReachBottom)||void 0===i||i.call(e),t.current=!0),!u&&t.current&&(t.current=!1)}}),[n,e]);(0,l.useEffect)((function(){var e;return o(),null===(e=n.current)||void 0===e||e.addEventListener("scroll",o,{passive:!0}),function(){var e;return null===(e=n.current)||void 0===e?void 0:e.removeEventListener("scroll",o)}}),[n,o])}(g,{onReachBottom:function(){x((function(n){return n>=b.length?b.length:n+r}))},reachBottomMargin:s}),(0,K.P)((function(n){var e=(0,o.Z)(n,1)[0],t=new Set(null===e||void 0===e?void 0:e.map((function(n){return null===n||void 0===n?void 0:n.key}))),i=b.map((function(n){return null===n||void 0===n?void 0:n.key}));e&&!d&&i.some((function(n){return!t.has(n)}))&&x(c)}),[b,d]),(0,i.jsx)(k.Z,{domRef:(0,dn.Z)(f,g),className:"List overflow-y-scroll ".concat(null!==m&&void 0!==m?m:""),style:(0,an.Z)((0,cn.Z)({},p),{contentVisibility:"auto"}),children:b.slice(0,h)})}mn.Item=function(n){var e=n.$isRenderByMain,t=n.children,o=n.className,r=void 0===o?"":o,l=n.style,u=n.domRef;return e?(0,i.jsx)("div",{className:"ListItem w-full ".concat(r),ref:u,style:l,children:t}):null};var vn=t(9785);function pn(n){var e=n.token1,t=n.token2,o=n.size,r=n.className,l=n.CoinAvatar1,u=n.CoinAvatar2;return(0,i.jsxs)(a.Z,{className:(0,y.m)("-space-x-1",r),children:[(0,i.jsx)(vn.Z,(0,cn.Z)({size:o,token:e},l)),(0,i.jsx)(vn.Z,(0,cn.Z)({size:o,token:t},u))]})}var bn=t(8764).Buffer;var Zn=t(7499);function hn(n){var e=n.open,t=n.onClose,r=n.className,c=(0,g.Z)((function(n){return n.currentHydratedInfo})),s=(0,g.Z)((function(n){return n.removeAmount})),d=(0,f.Z)((function(n){return n.connected})),m=(0,o.Z)(l.useState(!1),2),v=m[0],b=m[1],h=(0,o.Z)(l.useState(!1),2),k=h[0],S=h[1],w=(0,l.useRef)(),A=(0,l.useRef)(),I=(0,x.Z)((function(n){return n.isApprovePanelShown}));return(0,i.jsx)(Zn.Z,{open:e,onClose:function(){t(),g.Z.setState({removeAmount:""}),S(!1),b(!1)},children:function(n){var e=n.close;return(0,i.jsxs)(un.Z,{className:(0,y.m)("backdrop-filter backdrop-blur-xl p-8 rounded-3xl w-[min(456px,90vw)] border-1.5 border-[rgba(171,196,255,0.2)] bg-cyberpunk-card-bg shadow-cyberpunk-card",r),size:"lg",children:[(0,i.jsxs)(a.Z,{className:"justify-between items-center mb-6",children:[(0,i.jsx)("div",{className:"text-xl font-semibold text-white",children:"Stake LP"}),(0,i.jsx)(Z.Z,{className:"text-[#ABC4FF] cursor-pointer",heroIconName:"x",onClick:e})]}),(0,i.jsx)(P.Z,{className:"mb-6",componentRef:w,topLeftLabel:"Pool",token:null===c||void 0===c?void 0:c.lpToken,onUserInput:function(n){g.Z.setState({removeAmount:n})},onInputAmountClampInBalanceChange:function(n){var e=n.negative,t=n.outOfMax;S(!!e),b(!!t)},onEnter:function(n){var e,t;n&&(null===(e=A.current)||void 0===e||null===(t=e.click)||void 0===t||t.call(e))}}),(0,i.jsxs)(a.Z,{className:"flex-col gap-1",children:[(0,i.jsx)(u.Z,{className:"frosted-glass frosted-glass-teal",componentRef:A,disabled:I,validators:[{should:(0,_.gt)(s,0)},{should:!v,fallbackProps:{children:"Amount Too Large"}},{should:!k,fallbackProps:{children:"Negative Amount"}},{should:d,forceActive:!0,fallbackProps:{onClick:function(){return x.Z.setState({isWalletSelectorShown:!0})},children:"Connect Wallet"}}],onClick:function(){new Promise((function(n,e){return(0,N.Z)(C().mark((function e(){var t,i,r,l,u,c,a,s,d,m,v,p,b,Z,h,k,y,S,w,P,A,I,N,T,q,L,B,R,E;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Test"),!x.Z.getState().isApprovePanelShown){e.next=4;break}return e.abrupt("return");case 4:return t=Q.Z.getState().program,i=U.Z.getState().connection,r=f.Z.getState(),l=r.owner,u=r.getTokenAccount,c=j.ZP.getState().getToken,a=g.Z.getState(),s=a.coin1,d=a.coin2,m=a.currentPoolInfo,v=a.removeAmount,x.Z.setState({isApprovePanelShown:!0}),e.prev=10,(0,J.Z)(v,"user have not input amount to remove lp"),(0,J.Z)(i,"no rpc connection"),(0,J.Z)(t,"market not found"),(0,J.Z)(l,"wallet not found"),(0,J.Z)(m,"can't find liquidity pool"),(0,J.Z)(s,"select a coin in upper box"),(0,J.Z)(d,"select a coin in lower box"),p=c(m.baseMint),(0,J.Z)(p,"can't find base token in tokenList"),b=c(m.quoteMint),(0,J.Z)(b,"can't find quote token in tokenList"),Z=c(m.lpMint),(0,J.Z)(Z,"can't find lp token in tokenList"),h=u(m.baseMint),k=u(m.quoteMint),y=u(m.lpMint),S=(0,D.n)(Z,v,{alreadyDecimaled:!0}),(0,J.Z)(null===h||void 0===h?void 0:h.publicKey,"user haven't base token's account"),(0,J.Z)(null===k||void 0===k?void 0:k.publicKey,"user haven't quote token's account"),(0,J.Z)(null===y||void 0===y?void 0:y.publicKey,"user haven't liquidity pool's account"),w=new en.PublicKey(m.baseMint),P=new en.PublicKey(m.quoteMint),A=new en.PublicKey(m.baseVault),I=new en.PublicKey(m.quoteVault),N=new en.PublicKey(m.lpMint),T=new en.PublicKey(m.authority),e.t0=o.Z,e.next=40,tn.rV.PublicKey.findProgramAddress([bn.from(Q.u),bn.from(m.pair),new en.PublicKey(m.baseMint).toBuffer(),new en.PublicKey(m.quoteMint).toBuffer()],t.programId);case 40:return e.t1=e.sent,q=(0,e.t0)(e.t1,1),L=q[0],e.next=45,t.methods.withdrawLiquidity(m.pair,S.raw).accounts({owner:l,config:L,tokenXMint:w,tokenYMint:P,tokenXVault:A,tokenYVault:I,poolMint:N,poolAuthority:T,userTokenXVault:h.publicKey,userTokenYVault:k.publicKey,userLpVault:y.publicKey,tokenProgram:on.H_}).rpc();case 45:return B=e.sent,e.next=48,i.confirmTransaction(B,"finalized");case 48:n({allSuccess:!0,txid:B}),e.next=59;break;case 51:e.prev=51,e.t2=e.catch(10),R=M.Z.getState().logError,console.warn(e.t2),E=(0,G.Z)(e.t2,Error)?(0,nn.v)(e.t2.message):String(e.t2),R("Error",E),n({allSuccess:!1,txid:""});case 59:return e.prev=59,x.Z.setState({isApprovePanelShown:!1}),e.finish(59);case 62:case"end":return e.stop()}}),e,null,[[10,51,59,62]])})))()})).then((function(n){n.allSuccess&&((0,M.Z.getState().logSuccess)("Success","Remove ".concat((0,p.B)(s)," Lp Tokens")),g.Z.setState({removeAmount:""}),S(!1),b(!1),t())}))},children:"Remove Liquidity"}),(0,i.jsx)(u.Z,{type:"text",className:"text-sm text-[#ABC4FF] opacity-50 backdrop-filter-none",onClick:e,children:"Cancel"})]})]})}})}var xn=(0,r.Z)({coinInputBox1ComponentRef:(0,l.createRef)(),coinInputBox2ComponentRef:(0,l.createRef)(),liquidityButtonComponentRef:(0,l.createRef)()}),gn=xn.ContextProvider,kn=xn.useStore;function yn(){return function(){var n=(0,q.useRouter)(),e=n.query,t=n.pathname,o=n.replace,i=(0,g.Z)((function(n){return n.coin1})),r=(0,g.Z)((function(n){return n.coin2})),u=(0,g.Z)((function(n){return n.coin1Amount})),c=(0,g.Z)((function(n){return n.coin2Amount})),a=(0,g.Z)((function(n){return n.focusSide})),s=(0,g.Z)((function(n){return n.poolInfos})),d=(0,g.Z)((function(n){return n.ammId})),f=(0,g.Z)((function(n){return n.isRemoveDialogOpen})),m=(0,l.useCallback)((function(n){return s.find((function(e){return e.id===n}))}),[s]),v=(0,g.Z)((function(n){return n.findLiquidityInfoByTokenMint})),p=(0,j.ZP)((function(n){return n.tokens})),b=(0,j.ZP)((function(n){return n.getToken})),Z=(0,j.ZP)((function(n){return n.toUrlMint})),h=(0,x.Z)((function(n){return n.inCleanUrlMode})),k=(0,l.useRef)(!1);(0,l.useEffect)((function(){t.includes("/liquidity")||(k.current=!1)}),[t]),(0,l.useEffect)((function(){var n=function(){return k.current=!1};return null===globalThis||void 0===globalThis||globalThis.addEventListener("beforeunload",n),function(){return null===globalThis||void 0===globalThis?void 0:globalThis.removeEventListener("beforeunload",n)}}),[]),(0,E.Z)((0,N.Z)(C().mark((function n(){var o,l,u,c,d,f,Z,h,x,y,S,w,P,j,A,I,N,T,q,L,B,E,K,V,D;return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.includes("/liquidity")){n.next=2;break}return n.abrupt("return");case 2:if(!k.current){n.next=4;break}return n.abrupt("return");case 4:if(o=M.Z.getState().logWarning,c=String(null!==(u=null!==(l=e.ammId)&&void 0!==l?l:e.ammid)&&void 0!==u?u:""),f=String(null!==(d=e.coin0)&&void 0!==d?d:""),h=String(null!==(Z=e.coin1)&&void 0!==Z?Z:""),y=String(null!==(x=e.amount0)&&void 0!==x?x:""),w=String(null!==(S=e.amount1)&&void 0!==S?S:""),j=String(null!==(P=e.fixed)&&void 0!==P?P:""),I=String(null!==(A=e.mode)&&void 0!==A?A:""),!(c||f&&h)){n.next=39;break}if(N=b(f),T=b(h),!c){n.next=26;break}n.t0=m(c),n.next=34;break;case 26:if(!N||!T){n.next=32;break}return n.next=29,v(N.mint,T.mint);case 29:n.t1=n.sent.best,n.next=33;break;case 32:n.t1=void 0;case 33:n.t0=n.t1;case 34:q=n.t0,L=f?b(f,{exact:!0}):b(h?null===q||void 0===q?void 0:q.quoteMint:null===q||void 0===q?void 0:q.baseMint),B=h?b(h,{exact:!0}):b(f?null===q||void 0===q?void 0:q.baseMint:null===q||void 0===q?void 0:q.quoteMint),String(null===i||void 0===i?void 0:i.mint)===String(null===L||void 0===L?void 0:L.mint)&&String(null===r||void 0===r?void 0:r.mint)===String(null===B||void 0===B?void 0:B.mint)||g.Z.setState((0,R.dI)({coin1:L,coin2:B})),q?g.Z.setState({currentPoolInfo:q,ammId:q.id}):c&&s.length>0&&o("can't find Liquidity pool with url ammId");case 39:if(s.length>0&&Object.keys(p).length>0&&(k.current=!0),K=h?w:f?y:void 0,(E=f?y:h?w:void 0)&&g.Z.setState({coin1Amount:E}),K&&g.Z.setState({coin2Amount:K}),!I||I.toLowerCase()!=="removeLiquidity".toLowerCase()){n.next=49;break}if(!g.Z.getState().isRemoveDialogOpen){n.next=48;break}return n.abrupt("return");case 48:g.Z.setState({isRemoveDialogOpen:!0});case 49:V="coin1"===a?"coin0":"coin1",("coin0"===j||"coin1"===j)&&V!==j&&(D="coin0"===j?"coin1":"coin2",g.Z.setState({focusSide:D}));case 52:case"end":return n.stop()}}),n)}))),[t,e,b,p,o,i,r,s,m,v]);var y=(0,l.useCallback)((0,L.P)((function(n,e){o({pathname:n,query:e},void 0,{shallow:!0})}),{delay:500}),[]);(0,K.P)((function(){if(t.includes("/liquidity")&&k.current&&!h){var n,o,l,s,m,v,p,b,x=i?Z(i):"",g=r?Z(r):"",S=(0,R.dI)({coin0:String(null!==(n=e.coin0)&&void 0!==n?n:""),coin1:String(null!==(o=e.coin1)&&void 0!==o?o:""),amount0:String(null!==(l=e.amount0)&&void 0!==l?l:""),amount1:String(null!==(s=e.amount1)&&void 0!==s?s:""),fixed:String(null!==(m=e.fixed)&&void 0!==m?m:""),ammId:String(null!==(p=null!==(v=e.ammId)&&void 0!==v?v:e.ammid)&&void 0!==p?p:""),mode:String(null!==(b=e.mode)&&void 0!==b?b:"")}),w=(0,R.dI)({coin0:x,coin1:g,amount0:u,amount1:c,fixed:"coin1"===a?"coin0":"coin1",ammId:d,mode:f?"removeLiquidity":""});!(0,B.Ek)(S,w)&&y(t,w)}}),[h,i,r,u,c,a,d,f,e,o,t])}(),function(){var n=(0,j.ZP)((function(n){return n.getToken}));(0,l.useEffect)((function(){setTimeout((function(){var e=g.Z.getState(),t=e.coin1,o=e.coin2;t||(0,I.ZP)(null===o||void 0===o?void 0:o.mint)===(0,I.ZP)(A.i)||g.Z.setState({coin1:n(A.i)}),o||(0,I.ZP)(null===t||void 0===t?void 0:t.mint)===(0,I.ZP)(A.U)||g.Z.setState({coin2:n(A.U)})}))}),[n])}(),function(){var n=(0,g.Z)((function(n){return n.coin1})),e=(0,g.Z)((function(n){return n.coin2})),t=(0,g.Z)((function(n){return n.ammId})),o=(0,g.Z)((function(n){return n.currentPoolInfo}));(0,l.useEffect)((function(){var n,e;if(t){var o=g.Z.getState(),i=o.coin1,r=o.coin2,l=o.poolInfos,u=l.find((function(n){return n.id===t}));if((!(0,B.aT)(null===i||void 0===i?void 0:i.mint,null===u||void 0===u?void 0:u.baseMint)||!(0,B.aT)(null===r||void 0===r?void 0:r.mint,null===u||void 0===u?void 0:u.quoteMint))&&(!(0,B.aT)(null===i||void 0===i?void 0:i.mint,null===u||void 0===u?void 0:u.quoteMint)||!(0,B.aT)(null===r||void 0===r?void 0:r.mint,null===u||void 0===u?void 0:u.baseMint))){var c=j.ZP.getState().getToken,a=c(null===(n=l.find((function(n){return n.id===t})))||void 0===n?void 0:n.baseMint),s=c(null===(e=l.find((function(n){return n.id===t})))||void 0===e?void 0:e.quoteMint);g.Z.setState({coin1:a,coin2:s})}}}),[t]),(0,E.Z)((0,N.Z)(C().mark((function t(){var o,i,r,l,u;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=g.Z.getState(),i=o.findLiquidityInfoByTokenMint,r=o.ammId,t.next=3,i(null===n||void 0===n?void 0:n.mint,null===e||void 0===e?void 0:e.mint);case 3:if(l=t.sent,!(u=l.best)){t.next=11;break}if(r!==(null===u||void 0===u?void 0:u.id)){t.next=8;break}return t.abrupt("return");case 8:g.Z.setState({ammId:null===u||void 0===u?void 0:u.id,currentPoolInfo:u}),t.next=12;break;case 11:g.Z.setState({ammId:void 0,currentPoolInfo:void 0});case 12:case"end":return t.stop()}}),t)}))),[n,e]),(0,l.useEffect)((function(){var n=g.Z.getState(),e=n.poolInfos,o=n.currentPoolInfo;if((null===o||void 0===o?void 0:o.id)!==t){var i=e.find((function(n){return n.id===t}));g.Z.setState({currentPoolInfo:i})}}),[t]),(0,l.useEffect)((function(){var n=g.Z.getState().ammId;if((null===o||void 0===o?void 0:o.id)!==n){var e=null===o||void 0===o?void 0:o.id;g.Z.setState({ammId:e})}}),[o])}(),z(),null}var Sn=function(){return(0,i.jsxs)(gn,{children:[(0,i.jsx)(yn,{}),(0,i.jsx)("div",{style:{padding:"env(safe-area-inset-top, 0px) env(safe-area-inset-right, 0px) env(safe-area-inset-bottom, 0px) env(safe-area-inset-left, 0px)",position:"relative",display:"grid",gridTemplate:'\n          "d d d" auto\n          "a a a" auto\n          "b c c" 1fr\n          "b c c" 1fr / auto 1fr 1fr',overflow:"hidden",willChange:"opacity"},className:"w-screen mobile:w-full h-screen mobile:h-full",children:(0,i.jsxs)("main",{className:"PageLayoutContent relative isolate flex-container grid-area-c bg-gradient-to-b from-[#0c0927] to-[#110d36] rounded-tl-3xl mobile:rounded-none p-12 pb-4 pt-5 mobile:py-2 mobile:px-3",style:{overflowX:"hidden",overflowY:"scroll"},children:[(0,i.jsx)(a.Z,{className:"mb-12 mobile:mb-2 self-center",children:(0,i.jsx)(c.Z,{currentValue:"Liquidity",values:["Swap","Liquidity"],onChange:function(n){"Swap"===n&&(0,s.E)("/swap")}})}),(0,i.jsx)(wn,{}),(0,i.jsx)(Nn,{})]})})]})};function wn(){var n=(0,f.Z)().connected,e=(0,f.Z)((function(n){return n.checkWalletHasEnoughBalance})),t=(0,g.Z)(),r=t.coin1,c=t.coin1Amount,s=t.unslippagedCoin1Amount,m=t.coin2,v=t.coin2Amount,h=t.unslippagedCoin2Amount,k=t.focusSide,y=t.currentPoolInfo,S=t.currentPoolParsedInfo,w=t.refreshLiquidity,A=(0,j.ZP)((function(n){return n.refreshTokenPrice})),I=kn(),T=I.liquidityButtonComponentRef,q=I.coinInputBox1ComponentRef,L=I.coinInputBox2ComponentRef,B=(0,l.useMemo)((function(){return Boolean(y)}),[y]),R=(0,l.useMemo)((function(){return Boolean(S)}),[S]),E=r&&e((0,D.n)(r,"coin1"===k?c:s,{alreadyDecimaled:!0})),K=m&&e((0,D.n)(m,"coin2"===k?v:h,{alreadyDecimaled:!0})),V=(0,l.useRef)(null);(0,l.useEffect)((function(){g.Z.setState({scrollToInputBox:function(){var n;return null===(n=V.current)||void 0===n?void 0:n.scrollIntoView({behavior:"smooth",block:"center"})}})}),[]);var O,F,H=(0,x.Z)((function(n){return n.isApprovePanelShown}));return(0,i.jsxs)(d.Z,{domRef:V,wrapperClassName:"w-[min(456px,100%)] self-center cyberpunk-bg-light",className:"py-8 pt-4 px-6 mobile:py-5",children:[(0,i.jsx)(P.Z,{className:"mt-5",disabled:H,componentRef:q,value:"coin1"===k?c:s,haveHalfButton:!0,haveCoinIcon:!0,showTokenSelectIcon:!0,topLeftLabel:"",onTryToTokenSelect:function(){},onUserInput:function(n){g.Z.setState({coin1Amount:n,focusSide:"coin1"})},onEnter:function(n){var e,t,o,i;n&&(m||null===(e=L.current)||void 0===e||null===(t=e.selectToken)||void 0===t||t.call(e),m&&v&&(null===(o=T.current)||void 0===o||null===(i=o.click)||void 0===i||i.call(o)))},token:r}),(0,i.jsxs)("div",{className:"relative h-8 my-4",children:[(0,i.jsxs)(a.Z,{className:"absolute h-full items-center transition-all left-1/2 -translate-x-1/2",children:[(0,i.jsx)(Z.Z,{heroIconName:"plus",className:"p-1 mr-4 mobile:mr-2 text-[#39D0D8]"}),(0,i.jsx)(b.U,{children:(0,i.jsx)(An,{className:"w-max"})})]}),(0,i.jsx)(a.Z,{className:"absolute right-0",children:(0,i.jsx)($.Z,{run:!H,refreshKey:"liquidity/add",popPlacement:"right-bottom",freshFunction:function(){H||(w(),A())}})})]}),(0,i.jsx)(P.Z,{componentRef:L,disabled:H,value:"coin2"===k?v:h,haveHalfButton:!0,haveCoinIcon:!0,showTokenSelectIcon:!0,topLeftLabel:"",onTryToTokenSelect:function(){},onEnter:function(n){var e,t,o,i;n&&(r||null===(e=q.current)||void 0===e||null===(t=e.selectToken)||void 0===t||t.call(e),r&&c&&(null===(o=T.current)||void 0===o||null===(i=o.click)||void 0===i||i.call(o)))},onUserInput:function(n){g.Z.setState({coin2Amount:n,focusSide:"coin2"})},token:m}),(0,i.jsx)(b.Z,{show:B,children:(0,i.jsx)(jn,{className:"mt-5"})}),(0,i.jsx)(u.Z,{className:"block frosted-glass-teal w-full mt-5",componentRef:T,disabled:H,validators:[{should:B,fallbackProps:{children:"Pool not found"}},{should:n,forceActive:!0,fallbackProps:{onClick:function(){return x.Z.setState({isWalletSelectorShown:!0})},children:"Connect Wallet"}},{should:R,fallbackProps:{children:"Pool Info Loading..."}},{should:r&&m,fallbackProps:{children:"Select a token"}},{should:c&&(0,_.$u)(c)&&v&&(0,_.$u)(v),fallbackProps:{children:"Enter an amount"}},{should:E,fallbackProps:{children:"Insufficient ".concat(null!==(O=null===r||void 0===r?void 0:r.symbol)&&void 0!==O?O:""," balance")}},{should:K,fallbackProps:{children:"Insufficient ".concat(null!==(F=null===m||void 0===m?void 0:m.symbol)&&void 0!==F?F:""," balance")}},{should:(0,_.$u)(c)&&(0,_.$u)(v),fallbackProps:{children:"Enter an amount"}}],onClick:function(){new Promise((function(n){return(0,N.Z)(C().mark((function e(){var t,i,r,l,u,c,a,s,d,m,v,p,b,Z,h,k,y,S,w,P,j,A,I,N,T,q,L,B,R,E,K,V,O,F,H,z;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.Z.getState(),i=t.checkWalletHasEnoughBalance,r=t.owner,l=t.getTokenAccount,u=x.Z.getState().slippageTolerance,c=Q.Z.getState().program,a=U.Z.getState().connection,!x.Z.getState().isApprovePanelShown){e.next=7;break}return e.abrupt("return");case 7:return s=g.Z.getState(),d=s.coin1,m=s.coin2,v=s.coin1Amount,p=s.coin2Amount,b=s.currentPoolInfo,Z=s.focusSide,h=s.unslippagedCoin1Amount,k=s.unslippagedCoin2Amount,x.Z.setState({isApprovePanelShown:!0}),e.prev=9,(0,J.Z)(a,"no rpc connection"),(0,J.Z)(c,"market not found"),(0,J.Z)(r,"wallet not found"),(0,J.Z)(b,"can't find liquidity pool"),(0,J.Z)(d,"select a coin in upper box"),(0,J.Z)(m,"select a coin in lower box"),(0,J.Z)(String(d.mint)!==String(m.mint),"should not select same mint "),(0,J.Z)(v&&(0,_.gt)(v,0),"should input coin1 amount larger than 0"),(0,J.Z)(p&&(0,_.gt)(p,0),"should input coin2 amount larger than 0"),w=(0,D.n)(d,v,{alreadyDecimaled:!0}),P=(0,D.n)(m,p,{alreadyDecimaled:!0}),j=(0,D.n)(d,null!==h&&void 0!==h?h:v,{alreadyDecimaled:!0}),A=(0,D.n)(m,null!==k&&void 0!==k?k:p,{alreadyDecimaled:!0}),(0,J.Z)(i("coin1"===Z?w:j),"not enough ".concat(d.symbol)),(0,J.Z)(i("coin2"===Z?P:A),"not enough ".concat(m.symbol)),I=new en.PublicKey(b.baseMint),N=new en.PublicKey(b.quoteMint),T=new en.PublicKey(b.baseVault),q=new en.PublicKey(b.quoteVault),L=new en.PublicKey(b.lpMint),B=new en.PublicKey(b.authority),R=[],e.t0=o.Z,e.next=36,(0,rn.WT)(r,L,a);case 36:return e.t1=e.sent,E=(0,e.t0)(e.t1,2),K=E[0],E[1]||R.push(on.WU.createAssociatedTokenAccountInstruction(on._u,on.H_,L,K,r,r)),e.t2=o.Z,e.next=44,tn.rV.PublicKey.findProgramAddress([ln.from(Q.u),ln.from(b.pair),new en.PublicKey(b.baseMint).toBuffer(),new en.PublicKey(b.quoteMint).toBuffer()],c.programId);case 44:return e.t3=e.sent,V=(0,e.t2)(e.t3,1),O=V[0],e.next=49,c.methods.depositLiquidity(b.pair,w.raw,P.raw,u).accounts({owner:r,config:O,tokenXMint:I,tokenYMint:N,tokenXVault:T,tokenYVault:q,poolMint:L,poolAuthority:B,userTokenXVault:null===(y=l(w.token))||void 0===y?void 0:y.publicKey,userTokenYVault:null===(S=l(P.token))||void 0===S?void 0:S.publicKey,userLpVault:K,tokenProgram:on.H_}).preInstructions(R).rpc();case 49:return F=e.sent,e.next=52,a.confirmTransaction(F,"finalized");case 52:n({allSuccess:!0,txid:F}),e.next=63;break;case 55:e.prev=55,e.t4=e.catch(9),H=M.Z.getState().logError,console.warn(e.t4),z=(0,G.Z)(e.t4,Error)?(0,nn.v)(e.t4.message):String(e.t4),H("Error",z),n({allSuccess:!1,txid:""});case 63:return e.prev=63,x.Z.setState({isApprovePanelShown:!1}),e.finish(63);case 66:case"end":return e.stop()}}),e,null,[[9,55,63,66]])})))()})).then((function(n){n.allSuccess&&(0,M.Z.getState().logSuccess)("Success","Add ".concat((0,p.B)(c)," ").concat(null===r||void 0===r?void 0:r.symbol," and ").concat((0,p.B)(v)," ").concat(null===m||void 0===m?void 0:m.symbol))}))},children:"Add Liquidity"}),(0,i.jsx)(Pn,{})]})}function Pn(){var n=(0,f.Z)((function(n){return n.solBalance})),e=(0,v.hi)(n,Math.pow(10,m.Bk));return(0,i.jsx)(b.U,{children:(0,i.jsxs)(a.Z,{className:"text-sm mt-2 text-[#D8CB39] items-center justify-center",children:["SOL balance: ",(0,p.B)(e)," "]})})}function jn(n){var e,t,o,r,l,u,c,s,d=n.className,f=(0,g.Z)((function(n){return n.currentHydratedInfo})),m=(0,g.Z)((function(n){return n.currentPoolInfo})),Z=(0,g.Z)((function(n){return n.coin1})),h=(0,g.Z)((function(n){return n.coin2})),P=(0,g.Z)((function(n){return n.focusSide})),j=(0,g.Z)((function(n){return n.coin1Amount})),A=(0,g.Z)((function(n){return n.coin2Amount})),I=(0,x.Z)((function(n){return n.slippageTolerance})),N=String(null===m||void 0===m?void 0:m.baseMint)===String(null===Z||void 0===Z?void 0:Z.mint),T=N?Z:h,C=N?h:Z,q=(null===f||void 0===f?void 0:f.baseToken)?(0,D.n)(f.baseToken,f.baseReserve):void 0,M=(null===f||void 0===f?void 0:f.quoteToken)?(0,D.n)(f.quoteToken,f.quoteReserve):void 0;return(0,i.jsx)(k.Z,{className:(0,y.m)("py-4 px-6 flex-grow ring-inset ring-1.5 ring-[rgba(171,196,255,.5)] rounded-xl items-center",d),children:(0,i.jsxs)(k.Z,{className:"w-full",children:[(0,i.jsx)(In,{fieldName:"Base",fieldValue:"coin1"===P?null!==(e=null===Z||void 0===Z?void 0:Z.symbol)&&void 0!==e?e:"unknown":null!==(t=null===h||void 0===h?void 0:h.symbol)&&void 0!==t?t:"unknown"}),(0,i.jsx)(b.U,{children:(j||A)&&(0,i.jsx)(In,{fieldName:"Max Amount",fieldValue:"".concat((0,S.Z)("coin1"===P?A||"":null!==j&&void 0!==j?j:"",{fractionLength:"auto"})," ").concat("coin1"===P?null!==(o=null===h||void 0===h?void 0:h.symbol)&&void 0!==o?o:"unknown":null!==(r=null===Z||void 0===Z?void 0:Z.symbol)&&void 0!==r?r:"unknown")})}),(0,i.jsx)(In,{fieldName:"Pool liquidity (".concat(null!==(l=null===T||void 0===T?void 0:T.symbol)&&void 0!==l?l:"unknown",")"),fieldValue:(0,i.jsx)("div",{children:q?"".concat((0,S.Z)(q.toExact())," ").concat(null!==(u=null===T||void 0===T?void 0:T.symbol)&&void 0!==u?u:"unknown"):"--"})}),(0,i.jsx)(In,{fieldName:"Pool liquidity (".concat(null!==(c=null===C||void 0===C?void 0:C.symbol)&&void 0!==c?c:"unknown",")"),fieldValue:(0,i.jsx)("div",{children:M?"".concat((0,S.Z)(M.toExact())," ").concat(null!==(s=null===C||void 0===C?void 0:C.symbol)&&void 0!==s?s:"unknown"):"--"})}),(0,i.jsx)(In,{fieldName:"LP supply",fieldValue:(0,i.jsx)(a.Z,{className:"items-center gap-2",children:(0,i.jsx)("div",{children:(null===f||void 0===f?void 0:f.lpToken)?"".concat((0,S.Z)((0,p.B)((0,D.n)(f.lpToken,f.lpSupply)))," LP"):"--"})})}),(0,i.jsx)(In,{fieldName:"Slippage Tolerance",fieldValue:(0,i.jsxs)(a.Z,{className:"py-1 px-2 bg-[#141041] rounded-sm text-[#F1F1F2] font-medium text-xs -my-1",children:[(0,i.jsx)(w.Z,{className:"w-6",value:(0,p.B)((0,v.dC)(I,100),{decimalLength:"auto 2"}),onUserInput:function(n){var e=(0,v.hi)(parseFloat(n),100);e&&x.Z.setState({slippageTolerance:e})}}),(0,i.jsx)("div",{className:"opacity-50 ml-1",children:"%"})]})})]})})}function An(n){var e,t,r=n.className,u=(0,l.useState)(!1),c=u[0],s=u[1],d=(0,g.Z)((function(n){return n.currentPoolInfo})),f=(0,g.Z)((function(n){return n.currentPoolParsedInfo})),m=(0,g.Z)((function(n){return n.coin1})),b=(0,g.Z)((function(n){return n.coin2})),Z=(0,x.Z)((function(n){return n.isMobile})),h=f?f.baseReserve:void 0,k=f?f.quoteReserve:void 0,S=String(null===d||void 0===d?void 0:d.baseMint)===String(null===m||void 0===m?void 0:m.mint),w=(0,o.Z)(S?[h,k]:[k,h],2),P=w[0],j=w[1],A=(0,_.$u)(P)&&j?(0,v.hi)(j,P):void 0,I=c?b:m,N=c?m:b;return A?(0,i.jsxs)(a.Z,{className:(0,y.m)("font-medium text-sm text-[#ABC4FF]",r),children:[1," ",null!==(e=null===I||void 0===I?void 0:I.symbol)&&void 0!==e?e:"--"," \u2248"," ",(0,p.B)(c?(0,v.hi)(1,A):A,{decimalLength:Z?"auto 2":"auto",zeroDecimalNotAuto:!0})," ",null!==(t=null===N||void 0===N?void 0:N.symbol)&&void 0!==t?t:"--",(0,i.jsx)("div",{className:"ml-2 clickable",onClick:function(){return s((function(n){return!n}))},children:"\u21cb"})]}):null}function In(n){var e=n.className,t=n.fieldName,o=n.fieldValue,r=n.tooltipContent,l=n.debugForceOpen;return(0,i.jsxs)(a.Z,{className:(0,y.m)("w-full justify-between my-1.5",e),children:[(0,i.jsxs)(a.Z,{className:"items-center text-xs font-medium text-[#ABC4FF]",children:[(0,i.jsx)("div",{className:"mr-1",children:t}),r&&(0,i.jsxs)(h.Z,{className:e,placement:"bottom-right",forceOpen:l,children:[(0,i.jsx)(Z.Z,{size:"xs",heroIconName:"question-mark-circle",className:"cursor-help"}),(0,i.jsx)(h.Z.Panel,{children:r})]})]}),(0,i.jsx)("div",{className:"text-xs font-medium text-white",children:o})]})}function Nn(){var n,e,t,o,r=(0,g.Z)(),l=r.currentPoolInfo,u=r.currentPoolParsedInfo,c=r.currentHydratedInfo,s=(0,g.Z)((function(n){return n.isRemoveDialogOpen})),d=(0,f.Z)((function(n){return n.rawBalances})),m=(0,x.Z)((function(n){return n.isMobile}));return(0,i.jsxs)("div",{className:"mt-12 max-w-[456px] self-center w-full",children:[(0,i.jsx)("div",{className:"mb-6 text-xl font-medium text-white",children:"Your Liquidity"}),(0,i.jsxs)(un.Z,{className:"p-6 mt-6 mobile:py-5 mobile:px-3 bg-cyberpunk-card-bg w-full",size:"lg",children:[c&&l&&u?(0,i.jsx)(mn,{className:"flex flex-col gap-6 mobile:gap-5 mb-5",children:(0,i.jsx)(mn.Item,{children:(0,i.jsxs)(b.U,{children:[(0,i.jsxs)(a.Z,{className:"items-center justify-between",children:[(0,i.jsxs)(a.Z,{className:"gap-2 items-center",children:[(0,i.jsx)(pn,{className:"justify-self-center",token1:c.baseToken,token2:c.quoteToken,size:m?"sm":"md"}),(0,i.jsxs)("div",{className:"text-base font-normal text-[#abc4ff]",children:[null!==(t=null===(n=c.baseToken)||void 0===n?void 0:n.symbol)&&void 0!==t?t:"","/",null!==(o=null===(e=c.quoteToken)||void 0===e?void 0:e.symbol)&&void 0!==o?o:""]})]}),(0,i.jsxs)(h.Z,{children:[(0,i.jsx)(Z.Z,{size:"smi",iconSrc:"/icons/pools-remove-liquidity-entry.svg",className:"grid place-items-center w-10 h-10 mobile:w-8 mobile:h-8 ring-inset ring-1 mobile:ring-1 ring-[rgba(171,196,255,.5)] rounded-xl mobile:rounded-lg text-[rgba(171,196,255,.5)] clickable clickable-filter-effect",onClick:function(){g.Z.setState({isRemoveDialogOpen:!0})}}),(0,i.jsx)(h.Z.Panel,{children:"Remove Liquidity"})]})]}),(0,i.jsx)(k.Z,{className:"border-t-1.5 border-[rgba(171,196,255,.5)] mt-5 mobile:mt-4 py-5 gap-3",children:(0,i.jsxs)(a.Z,{className:"justify-between",children:[(0,i.jsx)("div",{className:"text-xs mobile:text-2xs font-medium text-[#abc4ff]",children:"Your Liquidity"}),(0,i.jsxs)("div",{className:"text-xs mobile:text-2xs font-medium text-white",children:[l.lpMint?(0,p.B)((0,v.hi)(d[String(l.lpMint)],Math.pow(10,l.lpDecimals)),{decimalLength:"auto ".concat(l.lpDecimals)}):"--"," ","LP"]})]})})]})})}):(0,i.jsx)("div",{children:"Loading info..."}),(0,i.jsx)(hn,{open:s,onClose:function(){g.Z.setState({isRemoveDialogOpen:!1})}})]})]})}}},function(n){n.O(0,[480,774,888,179],(function(){return e=2886,n(n.s=e);var e}));var e=n.O();_N_E=e}]);